# Introduction

The goal of this hands-on session is to perform an NGS alignment on the
sequencing data coming from a tumour and normal group of samples. We
will align raw sequencing data to the human genome using the BWA aligner
and then we will discuss the sequence alignment and mapping format
(SAM). SAM to BAM coversion, indexing and sorting will also be
demonstrated. These are important and essential steps for downstream
processing of the aligned BAM files.

This data is the whole genome sequencing of a lung adenocarcinoma
patient AK55. It was downloaded from `ERP001071`. Only the HiSeq2000 data
for `Blood` and `liverMets` were analysed.

Accession numbers associated with read data assigned by the European
Bioinformatics Institute (EBI) start with ’ER’. e.g. ERP is the study ID
and ERR is the run. The original FASTQ files downloaded had the ERR
number in front of each read name in the FASTQ file. The read name had
to be edited to remove the ERR number at the start of the name. This had
caused problems for downstream programs such as Picard for marking
optical duplicates.

We have used 4 Blood samples (8 PE `.fastq.gz` files) and 5 Liver
samples (10 PE `.fastq.gz` files) data from this study to perform the
whole genome alignment using the BWA aligner. The whole process took
\>150K CPU seconds per sample and the precomputed alignment will be used
in different sections of this workshop.

## Prepare the Environment

By now you know about the raw sequence fastq format generated by the
Illumina sequencers. Next we will see how fastq files are aligned with
the reference genome and what are the resulting standard alignment
format. In the interest of time we have selected only 1 million paired
reads from a Blood sample to demonstrate a BWA command. The remainining
alignments have already been performed for you and will be required in
the subsequent modules of the course.

The input data for this section can be found in the `alignment`
directory. Please follow the commands below to go to the
right folder and view top 10 lines of the input fastq file:

First, go to the right folder, where the data are stored.

```bash
$ cd /home/bioinfo/alignment/
$ ls
$ zless SM_Blood_ID_ERR059356.subset_R1.fastq.gz
```
